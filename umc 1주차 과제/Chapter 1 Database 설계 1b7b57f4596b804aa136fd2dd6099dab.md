# Chapter 1. Database 설계

<aside>
🚨 **주의사항!**

이번 1주차에서는 기본적인 **DDL, DML은 알고 계신다는 전제**로 시작하며, 서버 파트의 모집 자체를 **DB에 대한 사전 지식이 있는 분**을 모집했기에, 정말 기본적인 DB 용어 (외래키, 관계형 데이터베이스, 기본 키 등등)는 참고 링크만 드릴 예정이니 준비되지 않으신 챌린저들은 꼭 공부를 하시고 1주차를 진행해주시기 바랍니다.

</aside>

# 🎯 핵심 키워드

---

<aside>
💡 주요 내용들에 대해 조사해보고, 자신만의 생각을 통해 정리해보세요!
레퍼런스를 참고하여 정의, 속성, 장단점 등을 적어주셔도 됩니다.
조사는 공식 홈페이지 **Best**, 블로그(최신 날짜) **Not Bad**

</aside>

- 외래키
    
    다른 테이블에 있는 기본키를 참조하는 키
    
- 기본키
    
    PK. 유일성, 최소성, 불변성, 존재성을 만족하는, 한 테이블을 식별해주는 키
    
- ER 다이어그램
    
    Entity-Relation Diagram으로, 각 데이터 간의 관계를 표현하기 위한 그림
    
- 복합 키
    
    두 개 이상의 컬럼을 묶어서 하나의 식별자로 사용하는 것. 복합 키는 기본 키로도 사용될 수 있음
    
- 연관관계
    
    1:N, M:1, N:M 등 두 개 이상의 객체 간의 관계를 의미함
    
- 정규화
    
    [정보처리 실기_데이터베이스06강_정규화](https://youtu.be/RXQ1kZ_JHqg?si=f0OPsoOWnJXSbqca)
    
    1차 정규화: 각 열이 하나의 값을 갖는 형태로 테이블 분해
    
    2차 정규화: 모든 주식별자에 다른 속성들이 종속되도록 테이블 분해
    
    3차 정규화: 주식별자가 아닌 다른 속성에 종속되는 속성들을 분해
    
- 반 정규화
    
    정규화를 너무 많이 진행시키면 조인으로 인해 조회 성능이 떨어진다. 이를 방지하고자 반정규화를 실시하기도 한다.
    

## 📢 학습 후기

---

- 이번 주차 워크북을 해결해보면서 어땠는지 회고해봅시다.
- 핵심 키워드에 대해 완벽하게 이해했는지? 혹시 이해가 안 되는 부분은 뭐였는지?

<aside>
💡 지금까지 접했던 ERD는 간단한 수준이었는데, 복잡한 ERD를 그려보려니 어떻게 그려야 할 지 감이 안 왔습니다. 좀 더 공부해야 할 부분인 것 같습니다.

</aside>

## ⚠️ 스터디 진행 방법

---

1. 스터디를 진행하기 전, 워크북 내용들을 모두 채우고 스터디에서는 서로 모르는 내용들을 공유해주세요.
2. 미션은 워크북 내용들을 모두 완료하고 나서 스터디 전/후로 진행해보세요.
3. 다음주 스터디를 진행하기 전, 지난주 미션을 서로 공유해서 상호 피드백을 진행하시면 됩니다.

## ✅ 실습 체크리스트

---

## ☑️ 실습 인증

---

## 🔥 미션

---

- **미션 자료**
    
    <aside>
    🚨 ❗**해당 자료는 챌린저분들의 미션을 위해 Plan 파트에서 제공해준 자료로,
    미션 외의 용도로 사용하는 것 및 유출을 절대 금합니다.**❗
    
    **❗아래 IA&WF 사진 및 for_UMC.fig 파일 및 파일 속 내용의 저작권은 모두 5th UMC Plan 파트장 아크(박승민)에게 있음을 밝힙니다.❗**
    
    </aside>
    
    - IA&WF 사진 파일
        
        아래 사진 외에도 첨부드린 사진에 해당하는 피그마 파일이 존재하니
        사진을 통해 보기 어려우시다면 피그마 파일을 이용해주세요!
        
        ![IA](for_UMC.png)
        
        IA
        
        ![WF](for_UMC%201.png)
        
        WF
        
    
    [for_UMC.fig](for_UMC.fig)
    
1. 주어진 IA(기획 플로우)와 와이어 프레임(디자인 프로토타입)을 보고 직접 데이터베이스를 설계해오기, 위에서 언급한 경우를 다 적용해서 할 것
2. 이름 글자 수 등 세부적인 부분은 원하는 대로 해도 됨!
3. 각 지역 별로 가게들이 있으며 가게를 방문하는 미션을 해결하며 포인트를 모으는 서비스
    1. 모든 지역마다 10개의 미션 클리어시 1000 point 부여로 고정

**최소한 로그인/회원가입, 미션, 홈 화면에 필요한 데이터는 설계를 해야함, 되어있지 않다면 원 아웃**

***미션 난이도 완화를 위해 지도 검색 기능 전부 pass, 저 부분은 설계 하지 마세요***

***내 포인트 관리, 알 부분도 설계하지 마세요***

***사장님이 자신의 점포 관리하는 부분도 설계 대상에서 제외입니다.***

물론 원하시면 하셔도 됩니다. 😉

**< 시니어 미션 >**

[시니어 미션](https://www.notion.so/1b7b57f4596b813e8f29f499c63206d6?pvs=21)

## 💪 미션 기록

---

<aside>
🍀 미션 기록의 경우, 아래 미션 기록 토글 속에 작성하시거나, 페이지를 새로 생성하여 해당 페이지에 기록하여도 좋습니다!

하지만, 결과물만 올리는 것이 아닌, **중간 과정 모두 기록하셔야 한다는 점!** 잊지 말아주세요.

</aside>

- **미션 기록**
    
    ![노트_250320_232532_1.png](%EB%85%B8%ED%8A%B8_250320_232532_1.png)
    
    요구 기능을 정리한 다음, 테이블로 만들어야 하는 것들을 정리했습니다.
    
    각 테이블에 들어가야 할 칼럼들을 간략하게 정리한 다음, 직접 erd를 만들어보고자 시작했습니다.
    
    ![스크린샷 2025-03-19 232836.png](%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2025-03-19_232836.png)
    
    1차 수정안입니다. 
    
    로그인과 회원가입 기능을 어떻게 구현할지 고민하다, 로그인은 db상에서 구현하는 것이 아님을 알게 되었습니다. 회원가입시 등록하는 정보는 개인정보 테이블에 따로 빼두고, 이를 사용자 테이블과 연결했습니다. 사용자 테이블에는 닉네임과 비밀번호를 저정하도록 했고, soft_delete를 수행하기 위해 계정 활성화 상태와 삭제여부를 등록했습니다.
    
    포인트 기능은 따로 빼두어 사용자 테이블과 연결했습니다. 한 계정마다 하나의 포인트가 있을 거라 생각해 1대1 연결을 했습니다.
    
    알람은 1:n, 도움말 또한 1:n 으로 구현했습니다.
    
    미션과 사용자 간 관계는 n:m입니다. 한 미션은 여러 사용자에게 주어질 수 있고, 한 사용자는 여러 미션을 받을 수 있습니다. 따라서 중간에 매핑 테이블을 두어 n:m 관계를 구현하도록 했습니다.
    
    이때 매핑 테이블에 수행 미션 카운트를 두어 미션 10개를 수행할 때마다 포인트를 받을 수 있게 했습니다.
    
    미션과 리뷰는 1:n 관계입니다. 한 미션에서 여러 개의 리뷰를 작성할 수 있도록 연결해두었습니다.
    
    미션에서 여러 개의 가게 목록을 볼 수 있도록 중간에 매핑 테이블을 두었습니다.
    
    가게목록은 여러 개의 가게를 가지며, 가게 상세정보와 1:n 관계를 가집니다. 
    
    각각의 가게는 여러 개의 리뷰를 가질 수 있습니다. 따라서 리뷰와 1:n 관계를 유지하게 두었습니다.
    
    ![스크린샷 2025-03-20 234255.png](%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2025-03-20_234255.png)
    
    2차 수정안입니다. erd를 만들면서 세 가지 질문사항이 있었습니다.
    
    1. 사용자와 미션의 관계가 n:m 관계인지라 매핑 테이블을 두어 연결했는데, 매핑 테이블에도 추가적인 칼럼을 사용할 수 있는지.
    2. 로그아웃, 회원탈퇴 기능을 erd 상에서 구현할 수 있는지.
    3. 미션과 가게 목록을 1:n 관계로 연결해야 하는 것인지.
    
    해당 질문에 대해 좋은 답변을 받았습니다.
    
    첫번쨰로 사용자와 미션은 n:m 관계입니다. 1차 수정안에서는 미션의 진행상태를 미션 테이블에서 정의했었습니다. 하지만 이 방법을 사용시, 누군가 미션 a를 완료한다면, 미션 a를 받은 다른 모든 사람들에게도 해당 미션이 완료된 상태로 뜨게 됩니다. 이를 방지하기 위해 매핑 테이블에 미션의 진행 상태 및 수행한 미션 개수가 뜨도록 했습니다. 
    
    두 번째로, 로그아웃 기능은 로그인과 마찬가지로 db상에서 나타내는 것이 아닙니다. 하지만, 회원탈퇴 여부는 db상에서 기록할 수 있습니다. 워크북에 있었던 hard delete, soft delete 방법 중 soft delete 방법을 채용하여 계정의 운용상태, 그리고 삭제여부를 표현하여 기능을 구현할 수 있도록 하였습니다.
    
    세 번째로, 미션과 가게 목록을 1:n 관계로 구현하는 대신, 가게 목록 테이블을 없애고 미션과 가게 정보를 1:n 관계로 연결하였습니다. 가게 상세 정보로 구성된 가게 목록 테이블이 필요하다 생각했는데, 답변을 듣고는 굳이 필요한 테이블이 아니라 생각되어 제거했습니다.
    
    ![스크린샷 2025-03-24 204847.png](%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2025-03-24_204847.png)
    
    3차 수정안입니다.
    
    1. 매핑 테이블의 이름을 received_mission에서 user_mission으로 수정했습니다. 매핑 테이블에 두 테이블을 연결한 이름을 넣어야 좀 더 직관적으로 테이블을 판단할 수 있단 것을 알게 되었습니다.
    2. market_information 테이블을 market으로 바꿔 테이블 이름의 직관성을 올렸습니다.
    3. 개인정보 테이블을 사용자 테이블과 통합하였습니다. 민감정보는 따로 관리하는 게 나을 것 같아 분리하였는데, 분리한다면 지속적인 조인으로 인한 성능 저하가 있을 거라 생각됩니다. 

## ⚡ 트러블 슈팅

---

<aside>
💡 실습하면서 생긴 문제들에 대해서, **이슈 - 문제 - 해결** 순서로 작성해주세요.

</aside>

<aside>
💡 스스로 해결하기 어렵다면? 스터디원들에게 도움을 요청하거나 **너디너리의 지식IN 채널에 질문**해보세요!

</aside>

- ⚡이슈 작성 예시 (이슈가 생기면 아래를 복사해서 No.1, No.2, No3 … 으로 작성해서 트러블 슈팅을 꼭 해보세요!)
    
    **`이슈`**
    
    👉 앱 실행 중에 노래 다음 버튼을 누르니까 앱이 종료되었다.
    
    **`문제`**
    
    👉 노래클래스의 데이터리스트의 Size를 넘어서 NullPointException이 발생하여 앱이 종료된 것이었다. 
    
    **`해결`**
    
    👉  노래 다음 버튼을 눌렀을 때 데이터리스트의 Size를 검사해 Size보다 넘어가려고 하면 다음으로 넘어가는 메서드를 실행시키지 않고, 첫 노래로 돌아가게끔 해결
    
    **`참고레퍼런스`**
    
    - 링크
- ⚡이슈 No.1
    
    **`이슈`**
    
    👉 erd를 그리는 중, 사용자와 미션 간 n:m 관계를 이룰 때 매핑 테이블에서 미션 수행 카운트를 세야 할 지, 미션 테이블에서 카운트를 세야 할 지 잘 알지 못 함.
    
    **`문제`**
    
    👉 매핑 테이블의 역할에 대해서 잘 알지 못 해 발생한 일.
    
    **`해결`**
    
    👉  스터디원에게 질문 후, 매핑 테이블에 대해 공부하며 매핑 테이블이 갖는 역할을 알고 이를 추가함.
    
    **`참고레퍼런스`**
    
    - [문제 해결 시 참고한 링크] - 도움 받았던 링크를 찾을 수 없어 첨부하지 못 했습니다. 다음엔 링크 확인 후 붙여넣겠습니다.

## 🤔 참고 자료

[1주차](1%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%201b7b57f4596b81d7812deb818ed8d754.csv)

---

Copyright © 2023 최용욱(똘이) All rights reserved.

Copyright © 2024, 2025 김준환(제이미) All rights reserved.