# Chapter 7. API 응답 통일 & 에러 핸들러

# 📢 학습 후기

---

- 이번 주차 워크북을 해결해보면서 어땠는지 회고해봅시다.
- 핵심 키워드에 대해 완벽하게 이해했는지? 혹시 이해가 안 되는 부분은 뭐였는지?

<aside>
💡

</aside>

# ⚠️ 스터디 진행 방법

---

1. 스터디를 진행하기 전, 워크북 내용들을 모두 채우고 스터디에서는 서로 모르는 내용들을 공유해주세요.
2. 미션은 워크북 내용들을 모두 완료하고 나서 스터디 전/후로 진행해보세요.
3. 다음주 스터디를 진행하기 전, 지난주 미션을 서로 공유해서 상호 피드백을 진행하시면 됩니다.

# 🔥 미션

---

### [UMC 서버 워크북 참고 자료](https://github.com/CYY1007/UMC_SERVER_WORKBOOK.git)

[GitHub - chock-cho/UMC-7th-spring-workbook at feature-week7-workbook](https://github.com/chock-cho/UMC-7th-spring-workbook/tree/feature-week7-workbook)

---

1. 위의 링크, 그리고 워크북을 보며 API 응답 통일과 에러 핸들러를 숙지하기.
2. **반드시** 본인 손으로 처음부터 끝까지 다 해보고 새 리포지토리 혹은 7주차 리포지토리에 새 브랜치에 push 후 해당 링크를 미션 기록지에 제출할 것.
3. 미션 진행 시 반드시 중간 중간 **과정 인증샷**을 남길 것.
4. ❗**필수**❗ ****RestControllerAdvice의 장점, 그리고 없을 경우 어떤 점이 불편한지도 조사하여 **미션 기록란**에 수록할 것.
5. ❗**필수**❗ **미션 목록 조회(진행중, 진행 완료) API 명세서** 작성하기 (이미 작성되어 있으면 상관 없음!)

# 💪 미션 기록

---

<aside>
🍀 미션 기록의 경우, 아래 미션 기록 토글 속에 작성하시거나, 페이지를 새로 생성하여 해당 페이지에 기록하여도 좋습니다!

하지만, 결과물만 올리는 것이 아닌, **중간 과정 모두 기록하셔야 한다는 점!** 잊지 말아주세요.

</aside>

- **미션 기록**
    
    ### @RestControllerAdvice란?
    
    - @ControllerAdvice 어노테이션과 @Response 어노테이션을 합친 어노테이션이다.
    - 둘은 spring 상에서 발생하는 예외들을 전역적으로 처리해준다는 점에서 같은 역할이나, RestControllerAdvice는 응답을 Json으로 내려준다는 점에서 그 차이가 있다.
    - 모든 예외에 대한 반환을 Json 형식으로 받을 수 있어 응답에 대한 일관성이 유지된다.
    - 이 어노테이션을 선언한 객체는 @Bean으로 정의되므로, 예외를 핸들링하는 클래스를 통해 메서드로 각 예외들을 처리할 수 있게 된다. 또한 에러 응답 로직이 모듈화되어 있어 변경이 쉬워진다.
    - RestControllerAdvice의 강력한 기능은 컨트롤러 로직과 에러 처리 로직의 분리이다.
    기존에는 예외 처리들을 위해 각 컨트롤러에서 try-catch문을 통해 처리해야 하는데, 이 어노테이션을 설정함으로써 try-catch 대신 메서드를 통해 예외를 처리할 수 있게 된다.
    
    RestControllerAdvice가 없을 때의 문제점
    
    - spring 상에서 발생하는 모든 예외들을 각 컨트롤러에서 처리해야 한다. 이는 곧 각 컨트롤러마다 try-catch를 해야 한다는 소리이다. 중복된 코드가 굉장히 많이 늘어나며, 코드의 가독성이 매우 저해된다.
    - 컨트롤러에서 처리되지 못 한 예외들이 모두 서버 에러 500으로 발생한다. 문제의 원인을 찾을 수가 없어 디버깅에 많은 시간이 소요된다.
    - 에러의 응답 형식이 API마다 각각 다르기 때문에 각각의 예외들에 대한 해석이 어려워진다.
    
    ### 미션 목록 조회(진행중, 진행 완료) API 명세서
    
    진행 중/진행 완료한 미션 목록 조회
    
    - **Api Endpoint**
    
    진행 중인 미션 조회
    **api/GET/users/{user-Id}/missions?status=ACTIVE** 
    진행 완료한 미션 조회
    **api/GET/users/{user-Id}/missions?status=INACTIVE**
    - **Response**
    missionId (Long) 미션의 id
    userId(Long) 미션을 받은 사용자의 id
    missionName(String) 미션의 이름
    description(String) 미션 설명
    repair(Integer) 미션 수행 보수
    createdAt(LocalDateTime) 미션 생성 시간
    updatedAt(LocalDateTime) 미션 변경 시간
    - **미션 성공시**
    
    ```java
    "mission": [
        {
          "missionId": 1,
          "userId": 1,
          "missionName": "감자탕 시켜먹기",
          "description": "조마루감자탕에서 감자탕 시켜먹기",
          "reward": 100,
          "status": "ACTIVE", // 미션 진행 중
          // "status": "INACTIVE" // 미션 진행 완료
          "createdAt": "2025-05-13T09:00:00Z",
          "updatedAt": "2025-05-13T10:00:00Z"
        },
    ```
    
    - **미션 실패시**
    
    ```java
    {
    	"error": "진행 중인 미션 불러오기에 실패했습니다."
    }
    ```
    
    - **발생할 수 있는 예외**
    1. id 불일치: 존재하지 않는 미션 id 탐색, 존재하지 않는 사용자 id 탐색
    2. 서버 에러 500: Internal Server Error
    3. API 없음 404: API 요청 url이 잘못된 경우
    4. HTTP 오류 405: HTTP 메서드를 잘못 호출한 경우
    5. 인증 오류 419: 사용자 인증이 만료되거나 유효하지 않은 경우

> **github 링크**
> 
> 
> 

[시니어 미션 ](https://www.notion.so/1e9b57f4596b81849d49c6c29340c68d?pvs=21)

# ⚡ 트러블 슈팅

---

<aside>
💡 실습하면서 생긴 문제들에 대해서, **이슈 - 문제 - 해결** 순서로 작성해주세요.

</aside>

<aside>
💡 스스로 해결하기 어렵다면? 스터디원들에게 도움을 요청하거나 **너디너리의 지식IN 채널에 질문**해보세요!

</aside>

- ⚡이슈 작성 예시 (이슈가 생기면 아래를 복사해서 No.1, No.2, No3 … 으로 작성해서 트러블 슈팅을 꼭 해보세요!)
    
    **`이슈`**
    
    👉 앱 실행 중에 노래 다음 버튼을 누르니까 앱이 종료되었다.
    
    **`문제`**
    
    👉 노래클래스의 데이터리스트의 Size를 넘어서 NullPointException이 발생하여 앱이 종료된 것이었다. 
    
    **`해결`**
    
    👉  노래 다음 버튼을 눌렀을 때 데이터리스트의 Size를 검사해 Size보다 넘어가려고 하면 다음으로 넘어가는 메서드를 실행시키지 않고, 첫 노래로 돌아가게끔 해결
    
    **`참고레퍼런스`**
    
    - 링크
- ⚡이슈 No.1
    
    **`이슈`**
    
    👉 [트러블이 생긴 상태 작성]
    
    **`문제`**
    
    👉 [어떤 이유로 해당 이슈가 일어났는지 작성]
    
    **`해결`**
    
    👉  [해결 방법 작성]
    
    **`참고레퍼런스`**
    
    - [문제 해결 시 참고한 링크]

---

Copyright © 2023 최용욱(똘이) All rights reserved.

Copyright © 2024 제이미(김준환) All rights reserved.