# ë¹ˆ ë¯¸ì…˜ í˜ì´ì§€

## ğŸ”‘í•µì‹¬ í‚¤ì›Œë“œ

1. Domain
- ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¤ë£¨ëŠ” í•µì‹¬ ê°œë…ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë‹´ê³  ìˆëŠ” ê°ì²´ ë˜ëŠ” ì˜ì—­ì„ ì˜ë¯¸í•´ìš”. Spring Data JPAì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ "ë„ë©”ì¸ ê°ì²´"ëŠ” @Entity ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤, ê³§ Entity í´ë˜ìŠ¤ë¥¼ ì˜ë¯¸í•´ìš”. ì´ í´ë˜ìŠ¤ì—ëŠ” DBì™€ì˜ ë§¤í•‘ ì •ë³´( @Column, @OneToMany ë“±ë“±)ì´ ë“¤ì–´ê°€ìš”

1. ì–‘ë°©í–¥ ë§¤í•‘
- JPAì—ì„œ ë‘ ì—”í‹°í‹°ê°€ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ëŠ” ê²½ìš°ë¥¼ ì–‘ë°©í–¥ ë§¤í•‘ì´ë¼ê³  í•´ìš”. ì´ì „ DB ì„¤ê³„ë¥¼ í†µí•´ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ëŠ” ì–‘ë°©í–¥ ê´€ê³„, N:M ê´€ê³„ì— ëŒ€í•´ ì‹¤ì§ˆì ì¸ ì—°ê²°ì„ í•´ì¤„ ë•Œë¥¼ ì´ì•¼ê¸° í•´ìš”. ì´ ë•Œ ì£¼ì˜í•  ì ì€ ì–‘ë°©í–¥ ê´€ê³„ì—ì„œ ê´€ê³„ì˜ ì£¼ì¸ì„ ì˜ ì„¤ì •í•˜ê±°ë‚˜, Json ì§ë ¬í™”ë¡œ ì¸í•œ ë¬´í•œ ìˆœí™˜ ì°¸ì¡° (A â†’ B â†’ A â†’ â€¦..)ë¥¼ ë°©ì§€í•´ì£¼ì–´ì•¼ í•´ìš”.

1. N + 1 ë¬¸ì œ
- JPAì—ì„œ ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ, Nê°œì˜ ì¶”ê°€ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ëŠ” ì„±ëŠ¥ ê´€ë ¨ ë¬¸ì œì—ìš”. ì´ ë¬¸ì œëŠ” í•˜ë‚˜ì˜ ì¿¼ë¦¬ë¡œ ë¶€ëª¨ ì—”í‹°í‹°, ì¦‰ ê´€ê³„ì˜ ì£¼ì¸ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•œ í›„ ìì‹, í•˜ìœ„ ì—”í‹°í‹° ê¹Œì§€ ì¡°íšŒí•˜ë©´ì„œ ì¶”ê°€ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ëŠ” ë¬¸ì œì—ìš”.

# ğŸ”¥Â ë¯¸ì…˜

---

### 1. ì›Œí¬ë¶ì—ì„œ ë‹¤ë£¨ì§€ ì•Šì€ ì—°ê´€ê´€ê³„ ë§¤í•‘

1. MemberMission ê¸°ì¤€ mission ì— ëŒ€í•œ ì—°ê´€ ê´€ê³„ ì½”ë“œê°€ ì—†ì–´, ì˜ˆì™¸ê°€ ë°œìƒí•˜ì˜€ë‹¤.
- ì˜ˆì™¸ ë¡œê·¸
    
    ```sql
    org.springframework.beans.factory.BeanCreationException: ~ ì¤‘ê°„ ìƒëµ ~: 
    Collection 'HelloJPA.PracticeJPA.domain.Mission.memberMissionList' is 'mappedBy' a property named 'mission' which does not exist in the target entity 'HelloJPA.PracticeJPA.domain.mapping.MemberMission
    ```
    
    - @OneToMany(mappedBy = "mission") ì´ë¼ê³  ì„¤ì •í–ˆëŠ”ë°, MemberMissioní´ë˜ìŠ¤ì— mission ì´ë¼ëŠ” í•„ë“œê°€ ì—†ì–´ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ì´ë‹¤.

```java
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "mission_id")
private Mission mission;
```

- ë‹¤ìŒê³¼ ê°™ì´ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ì„¤ì •í•˜ì—¬ ëŠê²¼ë˜ ì—°ê´€ê´€ê³„ë¥¼ ì—°ê²°í•˜ì—¬ì¤€ë‹¤.

1. Region, Store, Review ì— ê´€í•œ ì—°ê´€ ê´€ê³„ ì½”ë“œê°€ í•„ìš”í•˜ë‹¤.

```java
@Entity @Builder @Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED) @AllArgsConstructor
public class Region extends BaseEntity {

    @Id @GeneratedValue (strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    @OneToMany(mappedBy = "region", cascade = CascadeType.ALL)
    private List<Store> regionStoreList = new ArrayList<>();
}
```

```java

@Entity @Getter @Builder
@NoArgsConstructor(access = AccessLevel.PROTECTED) @AllArgsConstructor
public class Store extends BaseEntity {

    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    private String address;

    private Float score;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "region_id")
    private Region region;

    @OneToMany(mappedBy = "store", cascade = CascadeType.ALL)
    private List<Review> storeReviewList = new ArrayList<>();
}

```

```java
@Entity @Builder @Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED) @AllArgsConstructor
public class Review extends BaseEntity {

    @Id @GeneratedValue (strategy = GenerationType.IDENTITY)
    private Long id;

    private String body;

    private Float score;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "member_id")
    private Member member;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "store_id")
    private Store store;
}
```

### 2. ìƒì„±ëœ í…Œì´ë¸” í™•ì¸

![IntelliJ Table.png](IntelliJ_Table.png)

ë‹¤ìŒ SQLì„ ì‚¬ìš©í•˜ì—¬ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤. 

```sql
SELECT TABLE_NAME,COLUMN_NAME,DATA_TYPE, IS_NULLABLE, COLUMN_TYPE 
	FROM INFORMATION_SCHEMA.COLUMNS 
	WHERE TABLE_SCHEMA = 'umc8th';
```

https://github.com/jijysun/Studing_JPA
